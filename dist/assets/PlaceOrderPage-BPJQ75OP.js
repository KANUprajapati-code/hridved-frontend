import{u as N,b as f,j as e,a as v}from"./index-jnhJKHVM.js";import{b as w,r as p,L as S}from"./vendor-react-B8KVy-C4.js";import"./vendor-utils-C0Zqfgkc.js";import"./vendor-ui-cGIEGKxt.js";const A=()=>{const{cart:c,clearCart:g}=N(),{user:h}=f(),t=w(),[r,j]=p.useState({}),[l,x]=p.useState("Stripe");p.useEffect(()=>{h||t("/login");const s=JSON.parse(localStorage.getItem("shippingAddress"));s||t("/shipping"),j(s)},[t,h]);const d=(c==null?void 0:c.cartItems)||[],o=s=>(Math.round(s*100)/100).toFixed(2),n=o(d.reduce((s,a)=>s+a.price*a.qty,0)),m=o(n>500?0:50),b=o(0),u=(Number(n)+Number(m)+Number(b)).toFixed(2),y=async()=>{var s,a;if(!r.houseNumber){alert("Please add a shipping address"),t("/checkout/address");return}try{const{data:i}=await v.post("/orders",{orderItems:d,shippingAddress:{...r,addressId:r._id},paymentMethod:l,itemsPrice:n,shippingPrice:m,taxPrice:b,totalPrice:u});g(),t(`/order/${i._id}`)}catch(i){console.error(i),alert(((a=(s=i.response)==null?void 0:s.data)==null?void 0:a.message)||"Error placing order")}};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-serif font-bold text-primary mb-8",children:"Place Order"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[e.jsxs("div",{className:"md:w-2/3 space-y-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded shadow-sm border",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800",children:"Shipping"}),e.jsxs("p",{className:"mb-2",children:[e.jsx("strong",{children:"Address: "}),r.houseNumber,", ",r.landmark?`${r.landmark}, `:"",r.city,", ",r.state," - ",r.pincode]})]}),e.jsxs("div",{className:"bg-white p-6 rounded shadow-sm border",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800",children:"Payment Method"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("label",{className:"flex items-center gap-3 p-3 border rounded cursor-pointer hover:bg-gray-50 transition",children:[e.jsx("input",{type:"radio",name:"paymentMethod",value:"Stripe",checked:l==="Stripe",onChange:s=>x(s.target.value),className:"accent-primary w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Credit/Debit Card (Stripe)"})]}),e.jsxs("label",{className:"flex items-center gap-3 p-3 border rounded cursor-pointer hover:bg-gray-50 transition",children:[e.jsx("input",{type:"radio",name:"paymentMethod",value:"COD",checked:l==="COD",onChange:s=>x(s.target.value),className:"accent-primary w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Cash on Delivery (COD)"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded shadow-sm border",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800",children:"Order Items"}),d.length===0?e.jsx("p",{children:"Your cart is empty"}):e.jsx("div",{className:"space-y-4",children:d.map((s,a)=>e.jsxs("div",{className:"flex items-center gap-4 border-b last:border-0 pb-4 last:pb-0",children:[e.jsx("img",{src:s.image,alt:s.name,className:"w-12 h-12 rounded object-cover"}),e.jsx(S,{to:`/product/${s.product}`,className:"flex-1 hover:text-primary",children:s.name}),e.jsxs("div",{className:"text-gray-600",children:[s.qty," x ₹",s.price," = ",e.jsxs("span",{className:"font-bold text-gray-900",children:["₹",s.qty*s.price]})]})]},a))})]})]}),e.jsx("div",{className:"md:w-1/3",children:e.jsxs("div",{className:"bg-white p-6 rounded shadow-md border sticky top-24",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 border-b pb-2",children:"Order Summary"}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{children:"Items"}),e.jsxs("span",{children:["₹",n]})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{children:"Shipping"}),e.jsxs("span",{children:["₹",m]})]}),e.jsxs("div",{className:"flex justify-between mt-4 pt-4 border-t font-bold text-xl text-primary",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["₹",u]})]}),e.jsx("button",{type:"button",className:"w-full bg-primary text-white py-3 rounded mt-6 hover:bg-opacity-90 transition font-bold",disabled:d.length===0,onClick:y,children:"Place Order"})]})})]})]})};export{A as default};
