import{T as q,j as e,a as u}from"./index-DsP1R5yV.js";import{e as R,b as V,r}from"./vendor-react-B8KVy-C4.js";import{y as _,C as h,Y as F,c as Y,O as H,q as K,a0 as U,p as Z}from"./vendor-ui-DMuw5F6C.js";import"./vendor-utils-C0Zqfgkc.js";const ee=()=>{var w;const{doctorId:b}=R(),p=V(),{addToast:a}=r.useContext(q)||{},[s,D]=r.useState(null),[P,y]=r.useState(!0),[c,f]=r.useState("video"),[n,S]=r.useState(""),[o,z]=r.useState(""),[d,T]=r.useState(""),[x,I]=r.useState(""),[m,M]=r.useState(""),[j,A]=r.useState(""),[N,v]=r.useState(!1),E=["09:00 AM","09:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","02:00 PM","02:30 PM","03:00 PM","03:30 PM","04:00 PM","04:30 PM"];r.useEffect(()=>{(async()=>{try{const{data:l}=await u.get(`/doctors/${b}`);D(l),y(!1)}catch(l){console.error("Error fetching doctor:",l),a&&a("Doctor not found","error"),y(!1)}})()},[b,a]);const B=()=>{const t=new Date;return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]},O=()=>{const t=new Date;return t.setDate(t.getDate()+30),t.toISOString().split("T")[0]},L=async()=>{var t,l;if(!n||!o||!d||!x||!m){a&&a("Please fill all required fields","error");return}v(!0);try{const g={doctorId:b,doctorName:s.name,consultationType:c,appointmentDate:n,appointmentTime:o,patientName:d,patientPhone:x,patientEmail:m,issue:j,amount:s.fee,status:"pending"},{data:i}=await u.post("/doctor-bookings/doctor-booking",g);if(i.razorpayOrderId){const $={key:i.razorpayKeyId,amount:i.amount,currency:"INR",name:"Doctor Consultation",description:`Consultation with Dr. ${s.name}`,order_id:i.razorpayOrderId,handler:async k=>{try{(await u.post("/doctor-bookings/verify-doctor-booking",{orderId:i.razorpayOrderId,paymentId:k.razorpay_payment_id,signature:k.razorpay_signature})).data.success?(a&&a("Appointment booked successfully!","success"),setTimeout(()=>p("/profile"),2e3)):a&&a("Payment verification failed","error")}catch(C){console.error("Payment verification error:",C),a&&a("Payment verification failed","error")}},prefill:{name:d,email:m,contact:x},theme:{color:"#22c55e"}};new window.Razorpay($).open()}}catch(g){console.error("Booking error:",g),a&&a(((l=(t=g.response)==null?void 0:t.data)==null?void 0:l.message)||"Failed to initiate booking","error")}finally{v(!1)}};return P?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading doctor details..."})]})}):s?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-6xl",children:[e.jsxs("button",{onClick:()=>p(-1),className:"inline-flex items-center gap-2 text-green-600 font-bold mb-8 hover:text-green-700",children:[e.jsx(_,{size:18})," Back"]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8 sticky top-8",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("img",{src:s.image,alt:s.name,className:"w-32 h-32 rounded-full mx-auto mb-4 object-cover border-4 border-green-100"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s.name}),e.jsx("p",{className:"text-green-600 font-bold text-sm mt-2",children:s.specialization})]}),e.jsxs("div",{className:"space-y-4 mb-6 border-y border-gray-100 py-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-wider mb-1",children:"Experience"}),e.jsx("p",{className:"font-bold text-gray-800",children:s.experience})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-wider mb-1",children:"Patients"}),e.jsx("p",{className:"font-bold text-gray-800",children:s.patients})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-wider mb-1",children:"Languages"}),e.jsx("p",{className:"font-bold text-gray-800",children:((w=s.languages)==null?void 0:w.join(", "))||"English"})]})]}),s.quote&&e.jsx("div",{className:"bg-green-50 rounded-lg p-4 mb-6 border-l-4 border-green-500",children:e.jsxs("p",{className:"text-sm italic text-gray-700",children:['"',s.quote,'"']})}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:s.tags.map(t=>e.jsx("span",{className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-xs font-bold",children:t},t))}),e.jsxs("div",{className:"bg-green-50 rounded-xl p-6 border-2 border-green-200",children:[e.jsx("p",{className:"text-xs text-gray-600 font-bold uppercase tracking-wider mb-2",children:"Consultation Fee"}),e.jsxs("p",{className:"text-4xl font-bold text-green-600 mb-3",children:["₹",s.fee]}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(h,{size:16,className:"text-green-600"})," Instant Prescription"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(h,{size:16,className:"text-green-600"})," 30-45 Min Consultation"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(h,{size:16,className:"text-green-600"})," Digital Reports"]})]})]})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Book Your Appointment"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-4",children:"Consultation Type *"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>f("video"),className:`p-4 rounded-lg border-2 transition-all font-bold flex items-center justify-center gap-2 ${c==="video"?"border-green-500 bg-green-50 text-green-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:[e.jsx(F,{size:18})," Video Call"]}),e.jsxs("button",{onClick:()=>f("clinic"),className:`p-4 rounded-lg border-2 transition-all font-bold flex items-center justify-center gap-2 ${c==="clinic"?"border-green-500 bg-green-50 text-green-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:[e.jsx(Y,{size:18})," In-Clinic"]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(H,{size:16,className:"text-green-600"})," Select Date *"]}),e.jsx("input",{type:"date",value:n,onChange:t=>S(t.target.value),min:B(),max:O(),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-green-500 focus:outline-none font-bold"}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Select from next day to 30 days ahead"})]}),n&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(K,{size:16,className:"text-green-600"})," Select Time *"]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:E.map(t=>e.jsx("button",{onClick:()=>z(t),className:`p-3 rounded-lg border-2 transition-all font-bold text-sm ${o===t?"border-green-500 bg-green-50 text-green-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:t},t))})]}),e.jsxs("div",{className:"border-t border-gray-100 pt-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(U,{size:18,className:"text-green-600"})," Your Details"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Full Name *"}),e.jsx("input",{type:"text",value:d,onChange:t=>T(t.target.value),placeholder:"Enter your full name",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-green-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Email *"}),e.jsx("input",{type:"email",value:m,onChange:t=>M(t.target.value),placeholder:"Enter your email",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-green-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Phone Number *"}),e.jsx("input",{type:"tel",value:x,onChange:t=>I(t.target.value),placeholder:"Enter your phone number",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-green-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:"Health Concern"}),e.jsx("textarea",{value:j,onChange:t=>A(t.target.value),placeholder:"Describe your health concern (optional)",rows:"4",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-green-500 focus:outline-none"})]})]})]}),n&&o&&e.jsxs("div",{className:"bg-green-50 rounded-xl p-6 border-2 border-green-200",children:[e.jsx("h3",{className:"font-bold text-gray-900 mb-4",children:"Appointment Summary"}),e.jsxs("div",{className:"space-y-2 text-sm mb-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Doctor:"}),e.jsx("span",{className:"font-bold text-gray-900",children:s.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Type:"}),e.jsx("span",{className:"font-bold text-gray-900 capitalize",children:c==="video"?"Video Call":"In-Clinic Visit"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Date & Time:"}),e.jsxs("span",{className:"font-bold text-gray-900",children:[new Date(n).toLocaleDateString()," at ",o]})]}),e.jsxs("div",{className:"border-t border-green-300 pt-2 mt-2 flex justify-between",children:[e.jsx("span",{className:"text-gray-600 font-bold",children:"Total Amount:"}),e.jsxs("span",{className:"text-xl font-bold text-green-700",children:["₹",s.fee]})]})]})]}),e.jsxs("button",{onClick:L,disabled:N||!n||!o,className:"w-full bg-green-600 text-white py-4 rounded-lg font-bold text-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(Z,{size:20})," ",N?"Processing...":"Pay & Book Appointment"]}),e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"By booking, you agree to our Terms & Conditions. Cancellation allowed up to 2 hours before appointment."})]})]})})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Doctor not found"}),e.jsx("button",{onClick:()=>p("/consultation"),className:"text-green-600 font-bold hover:underline",children:"Back to doctors"})]})})};export{ee as default};
