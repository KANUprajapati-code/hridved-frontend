import{T as k,a as h,j as e}from"./index-DsP1R5yV.js";import{r as a,f as B,L as p}from"./vendor-react-B8KVy-C4.js";import{y as z,u as $,S as F,E as b,af as f,ae as L,s as A,k as D,l as E}from"./vendor-ui-DMuw5F6C.js";import"./vendor-utils-C0Zqfgkc.js";const H=()=>{const[c,m]=a.useState([]),[y,g]=a.useState(!0),[o,j]=a.useState(""),[n,N]=a.useState(""),[r,x]=a.useState(1),[l,v]=a.useState(null);B();const{addToast:t}=a.useContext(k)||{},u=a.useCallback(async()=>{try{g(!0);let s=`/blogs/admin/all?page=${r}&limit=15`;o&&(s+=`&search=${encodeURIComponent(o)}`),n&&(s+=`&status=${n}`);const{data:i}=await h.get(s);m(i.blogs),v(i.pagination)}catch(s){t&&t("Failed to load blogs","error"),console.error(s)}finally{g(!1)}},[r,o,n,t]);a.useEffect(()=>{u()},[r,o,n,u]);const w=s=>{j(s.target.value),x(1)},S=async(s,i)=>{try{await h.put(`/blogs/${s}/toggle-status`),t&&t(`Blog ${i==="published"?"unpublished":"published"} successfully`,"success"),u()}catch(d){t&&t("Failed to update blog status","error"),console.error(d)}},C=async(s,i)=>{if(window.confirm(`Are you sure you want to delete "${i}"?`))try{await h.delete(`/blogs/${s}`),t&&t("Blog deleted successfully","success"),m(c.filter(d=>d._id!==s))}catch(d){t&&t("Failed to delete blog","error"),console.error(d)}},P=async()=>{try{const{data:s}=await h.post("/blogs",{title:"Untitled Blog",shortDescription:"Click to edit...",content:"Start writing your blog content...",image:"https://via.placeholder.com/800x400",category:"General Wellness",author:"Admin"});window.location.href=`/admin/blog/${s._id}/edit`}catch(s){t&&t("Failed to create blog","error"),console.error(s)}};return y&&!c.length?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Loading blogs..."})]}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs(p,{to:"/admin",className:"flex items-center gap-2 text-gray-600 hover:text-primary mb-6 transition-colors font-medium",children:[e.jsx(z,{size:20})," Back to Dashboard"]}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Blog Management"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Manage and publish your blog articles"})]}),e.jsxs("button",{onClick:P,className:"bg-primary text-white px-6 py-2 rounded-lg flex items-center gap-2 hover:bg-opacity-90 transition-colors font-semibold whitespace-nowrap",children:[e.jsx($,{size:20})," Create Blog"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"relative md:col-span-2",children:[e.jsx("input",{type:"text",placeholder:"Search by title, category, or author...",value:o,onChange:w,className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),e.jsx(F,{size:18,className:"absolute left-3 top-3 text-gray-400"})]}),e.jsx("div",{children:e.jsxs("select",{value:n,onChange:s=>{N(s.target.value),x(1)},className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent bg-white",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"published",children:"Published"}),e.jsx("option",{value:"draft",children:"Draft"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 font-semibold text-gray-700",children:"Blog Title"}),e.jsx("th",{className:"p-4 font-semibold text-gray-700 hidden sm:table-cell",children:"Category"}),e.jsx("th",{className:"p-4 font-semibold text-gray-700 hidden md:table-cell",children:"Author"}),e.jsx("th",{className:"p-4 font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"p-4 font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"p-8 text-center text-gray-400",children:"No blogs found. Create your first blog to get started!"})}):c.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-200 overflow-hidden flex-shrink-0",children:e.jsx("img",{src:s.image,alt:s.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-semibold text-gray-900 truncate",title:s.title,children:s.title}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.createdAt).toLocaleDateString()})]})]})}),e.jsx("td",{className:"p-4 hidden sm:table-cell",children:e.jsx("span",{className:"inline-block px-3 py-1 rounded-full text-xs font-medium bg-blue-50 text-blue-700",children:s.category})}),e.jsx("td",{className:"p-4 hidden md:table-cell",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:s.authorImage||"https://via.placeholder.com/32",alt:s.author,className:"w-6 h-6 rounded-full object-cover"}),e.jsx("span",{className:"text-sm text-gray-600",children:s.author})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold ${s.status==="published"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:s.status==="published"?e.jsxs(e.Fragment,{children:[e.jsx(b,{size:12}),"Published"]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{size:12}),"Draft"]})})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>S(s._id,s.status),className:`p-2 rounded-lg transition-colors ${s.status==="published"?"text-yellow-600 hover:bg-yellow-50":"text-green-600 hover:bg-green-50"}`,title:s.status==="published"?"Unpublish":"Publish",children:s.status==="published"?e.jsx(f,{size:18}):e.jsx(b,{size:18})}),e.jsx(p,{to:`/admin/blog/${s._id}/edit`,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:e.jsx(L,{size:18})}),e.jsx("button",{onClick:()=>C(s._id,s.title),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:e.jsx(A,{size:18})})]})})]},s._id))})]})}),l&&l.totalPages>1&&e.jsxs("div",{className:"px-4 py-4 border-t border-gray-100 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",l.currentPage," of ",l.totalPages," (",l.totalBlogs," total)"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>x(r-1),disabled:r===1,className:"p-2 rounded-lg border border-gray-200 text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:e.jsx(D,{size:18})}),e.jsx("button",{onClick:()=>x(r+1),disabled:r===l.totalPages,className:"p-2 rounded-lg border border-gray-200 text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:e.jsx(E,{size:18})})]})]})]})]})};export{H as default};
