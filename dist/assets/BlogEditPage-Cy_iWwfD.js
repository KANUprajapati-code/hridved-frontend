import{T as ne,a as h,j as e}from"./index-jnhJKHVM.js";import{e as ie,b as de,r,L as E}from"./vendor-react-B8KVy-C4.js";import{c as ce}from"./imageCompression-nMn3csfP.js";import{y as Q,ad as V,X as ge,af as ue,E as Z,ae as me}from"./vendor-ui-cGIEGKxt.js";import"./vendor-utils-C0Zqfgkc.js";const ye=()=>{const{id:o}=ie(),A=de(),{addToast:a}=r.useContext(ne)||{},[ee,f]=r.useState(!0),[u,I]=r.useState(!1),[m,z]=r.useState(!1),[x,F]=r.useState(""),[y,j]=r.useState(""),[i,P]=r.useState(""),[v,B]=r.useState(""),[te,re]=r.useState(""),[c,N]=r.useState(""),[L,U]=r.useState("General Wellness"),[d,w]=r.useState([]),[p,q]=r.useState(""),[S,R]=r.useState(""),[b,C]=r.useState(""),[k,M]=r.useState(""),[T,O]=r.useState(""),[H,W]=r.useState("5 min read"),[n,D]=r.useState("draft"),[$,G]=r.useState(!1),ae=["Skin Care","Hair Health","Nutrition","Yoga","Stress Management","General Wellness","Ayurveda","Tips & Tricks","Product Guide","Other"],Y=r.useCallback(async()=>{try{const{data:t}=await h.get(`/blogs/${o}`);F(t.title),j(t.slug),P(t.shortDescription),B(t.content),re(t.excerpt||""),N(t.image),U(t.category),w(t.tags||[]),R(t.author),C(t.authorImage||""),M(t.metaTitle||""),O(t.metaDescription||""),W(t.readTime||"5 min read"),D(t.status||"draft"),G(t.isFeatured||!1),f(!1)}catch(t){a&&a("Failed to load blog","error"),console.error(t),f(!1)}},[o,a]);r.useEffect(()=>{o?Y():f(!1)},[o,Y]);const se=t=>{const l=t.target.value;F(l);const s=l.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-");j(s)},_=()=>{p.trim()&&!d.includes(p.trim())&&(w([...d,p.trim()]),q(""))},le=t=>{w(d.filter((l,s)=>s!==t))},K=async(t,l)=>{const s=t.target.files[0];if(s){z(!0);try{const g=await ce(s,{quality:.7,maxWidth:1600}),J=new FormData;J.append("image",g);const{data:oe}=await h.post("/upload",J);l(oe),a&&a("Image uploaded and compressed successfully","success")}catch(g){a&&a("Failed to upload image. It might be too large.","error"),console.error(g)}finally{z(!1)}}},X=async(t,l=!1)=>{if(t.preventDefault(),!x.trim()||!i.trim()||!v.trim()||!c||!S.trim()){a&&a("Please fill in all required fields","error");return}try{I(!0);const s={title:x,slug:y,shortDescription:i,content:v,excerpt:te||i.substring(0,300),image:c,category:L,tags:d,author:S,authorImage:b,metaTitle:k||x.substring(0,60),metaDescription:T||i.substring(0,160),readTime:H,status:l?"published":n,isFeatured:$};if(o)await h.put(`/blogs/${o}`,s),a&&a("Blog updated successfully","success");else{const{data:g}=await h.post("/blogs",s);a&&a("Blog created successfully","success"),A(`/admin/blog/${g._id}/edit`);return}A("/admin/bloglist")}catch(s){a&&a("Failed to save blog","error"),console.error(s)}finally{I(!1)}};return ee?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Loading blog..."})]}):e.jsxs("div",{children:[e.jsxs(E,{to:"/admin/bloglist",className:"inline-flex items-center text-primary hover:text-opacity-80 mb-6 transition-colors font-bold text-sm",children:[e.jsx(Q,{size:18,className:"mr-2"})," Back to Blogs"]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 bg-gradient-to-r from-primary/5 to-secondary/5 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:o?"Edit Blog":"Create New Blog"}),o&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["ID: ",o]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${n==="published"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:n==="published"?"Published":"Draft"})})]}),e.jsxs("form",{onSubmit:X,className:"p-8 space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Blog Title *"}),e.jsx("input",{type:"text",placeholder:"Enter an engaging blog title",value:x,onChange:se,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"URL Slug"}),e.jsx("input",{type:"text",placeholder:"auto-generated-from-title",value:y,onChange:t=>j(t.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all text-gray-500"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Auto-generated from title. Preview: /blog/",y]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Short Description *"}),e.jsx("textarea",{rows:"2",placeholder:"A compelling summary for blog listings and search results...",value:i,onChange:t=>P(t.target.value),maxLength:"500",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all resize-none"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[i.length,"/500 characters"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Featured Image *"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Enter image URL or upload",value:c,onChange:t=>N(t.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"})}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",id:"image-file",onChange:t=>K(t,N),className:"hidden",accept:"image/*"}),e.jsxs("label",{htmlFor:"image-file",className:"bg-gray-100 text-gray-700 px-6 py-3 rounded-lg cursor-pointer hover:bg-gray-200 border border-gray-300 flex items-center gap-2 transition-colors font-medium whitespace-nowrap",children:[e.jsx(V,{size:18}),m?"Uploading...":"Upload Image"]})]})]}),c&&e.jsx("div",{className:"mt-4 rounded-lg overflow-hidden border border-gray-200 max-w-sm",children:e.jsx("img",{src:c,alt:"Preview",className:"w-full h-40 object-cover"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Category *"}),e.jsx("select",{value:L,onChange:t=>U(t.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all bg-white",children:ae.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Author Name *"}),e.jsx("input",{type:"text",placeholder:"e.g. Ayurveda Expert",value:S,onChange:t=>R(t.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Read Time"}),e.jsx("input",{type:"text",placeholder:"e.g. 5 min read",value:H,onChange:t=>W(t.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Author Image"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Enter author image URL or upload",value:b,onChange:t=>C(t.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"})}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",id:"author-image-file",onChange:t=>K(t,C),className:"hidden",accept:"image/*"}),e.jsxs("label",{htmlFor:"author-image-file",className:"bg-gray-100 text-gray-700 px-6 py-3 rounded-lg cursor-pointer hover:bg-gray-200 border border-gray-300 flex items-center gap-2 transition-colors font-medium whitespace-nowrap",children:[e.jsx(V,{size:18}),m?"Uploading...":"Upload"]})]})]}),b&&e.jsx("div",{className:"mt-4 w-16 h-16 rounded-full overflow-hidden border border-gray-200",children:e.jsx("img",{src:b,alt:"Author",className:"w-full h-full object-cover"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Tags"}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("input",{type:"text",placeholder:"Add tags (press Enter or Add)",value:p,onChange:t=>q(t.target.value),onKeyPress:t=>{t.key==="Enter"&&(t.preventDefault(),_())},className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"}),e.jsx("button",{type:"button",onClick:_,className:"bg-gray-100 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-200 border border-gray-300 transition-colors font-medium",children:"Add"})]}),d.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:d.map((t,l)=>e.jsxs("span",{className:"inline-flex items-center gap-2 bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm font-medium",children:[t,e.jsx("button",{type:"button",onClick:()=>le(l),className:"hover:text-blue-900",children:e.jsx(ge,{size:14})})]},l))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Blog Content *"}),e.jsx("textarea",{rows:"15",placeholder:"Write your comprehensive blog content here. You can use line breaks for formatting...",value:v,onChange:t=>B(t.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all font-mono text-sm resize-vertical"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Plain text format. Use line breaks for paragraphs."})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"SEO Optimization"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Meta Title"}),e.jsx("input",{type:"text",placeholder:"SEO-friendly title (recommended 60 characters max)",value:k,onChange:t=>M(t.target.value.substring(0,60)),maxLength:"60",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[k.length,"/60 characters"]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Meta Description"}),e.jsx("textarea",{rows:"2",placeholder:"Meta description for search results (recommended 160 characters max)",value:T,onChange:t=>O(t.target.value.substring(0,160)),maxLength:"160",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all resize-none"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[T.length,"/160 characters"]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Publishing Options"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(E,{to:"/admin/bloglist",className:"flex items-center gap-2 text-gray-600 hover:text-primary mb-6 transition-colors font-medium",children:[e.jsx(Q,{size:20})," Back to Blogs"]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:$,onChange:t=>G(t.target.checked),className:"w-5 h-5 text-primary rounded focus:ring-primary accent-primary"}),e.jsx("span",{className:"font-medium text-gray-700",children:"Featured on blog homepage"})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("label",{className:"text-sm font-bold text-gray-700 block mb-3",children:"Status"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"draft",checked:n==="draft",onChange:t=>D(t.target.value),className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-gray-700",children:"Save as Draft"}),e.jsx(ue,{size:14,className:"text-gray-400"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"published",checked:n==="published",onChange:t=>D(t.target.value),className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-gray-700",children:"Publish (visible to all)"}),e.jsx(Z,{size:14,className:"text-green-500"})]})]})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6 flex flex-col sm:flex-row gap-4 justify-end",children:[e.jsx(E,{to:"/admin/bloglist",className:"px-6 py-3 rounded-lg border border-gray-300 text-gray-700 font-bold hover:bg-gray-50 transition-colors text-center",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:u||m,className:"bg-gray-600 text-white px-8 py-3 rounded-lg font-bold shadow-lg hover:bg-gray-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(me,{size:20}),u?"Saving...":"Save as "+n.charAt(0).toUpperCase()+n.slice(1)]}),n==="draft"&&e.jsxs("button",{type:"button",onClick:t=>X(t,!0),disabled:u||m,className:"bg-primary text-white px-8 py-3 rounded-lg font-bold shadow-lg shadow-primary/30 hover:bg-opacity-90 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(Z,{size:20}),u?"Publishing...":"Save & Publish"]})]})]})]})]})};export{ye as default};
