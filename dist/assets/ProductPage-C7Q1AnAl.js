import{j as e,a as S,F as _,u as q,b as H,T as O}from"./index-DsP1R5yV.js";import{r as a,e as U,b as W,L as C}from"./vendor-react-B8KVy-C4.js";import{P as F,a as Q}from"./ProductCard-CObmE8Fg.js";import{Z as V,k as X,l as Y,h as $,n as G,a as T,o as J,i as R,p as K,b as ee,H as se,g as te,q as re}from"./vendor-ui-DMuw5F6C.js";import{A as ae}from"./AnimatedPage-D9f9vAm_.js";import{S as E}from"./ScrollReveal-CR-2c4a2.js";import{A as k}from"./AnimatedButton-BHsbnN3-.js";import"./vendor-utils-C0Zqfgkc.js";const le=({images:r=[]})=>{const[l,s]=a.useState(0),[d,x]=a.useState(!1),[n,h]=a.useState({x:0,y:0}),g=r[l],u=o=>{if(!d)return;const c=o.currentTarget.getBoundingClientRect(),N=(o.clientX-c.left)/c.width*100,p=(o.clientY-c.top)/c.height*100;h({x:N,y:p})},y=()=>{s(o=>(o+1)%r.length)},i=()=>{s(o=>(o-1+r.length)%r.length)};return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"relative w-full aspect-square bg-gray-100 rounded-xl overflow-hidden cursor-zoom-in group border border-gray-200",onMouseMove:u,onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),children:[e.jsx(F,{src:g,alt:"Product",className:`w-full h-full transition-transform duration-200 ${d?"scale-200 cursor-zoom-out":"scale-100"}`,width:600,height:600}),!d&&e.jsx("div",{className:"absolute top-3 right-3 bg-white rounded-lg p-2 shadow-md opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(V,{size:20,className:"text-gray-700"})}),r.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:i,className:"absolute left-3 top-1/2 -translate-y-1/2 bg-white rounded-full p-2 shadow-lg hover:bg-gray-100 transition-colors z-10",children:e.jsx(X,{size:20})}),e.jsx("button",{onClick:y,className:"absolute right-3 top-1/2 -translate-y-1/2 bg-white rounded-full p-2 shadow-lg hover:bg-gray-100 transition-colors z-10",children:e.jsx(Y,{size:20})})]}),r.length>1&&e.jsxs("div",{className:"absolute bottom-3 right-3 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded",children:[l+1," / ",r.length]})]}),r.length>1&&e.jsx("div",{className:"grid grid-cols-4 gap-3",children:r.map((o,c)=>e.jsx("button",{onClick:()=>s(c),className:`aspect-square rounded-lg overflow-hidden border-2 transition-all ${l===c?"border-primary ring-2 ring-primary ring-offset-1":"border-gray-300 hover:border-primary"}`,children:e.jsx(F,{src:o,alt:`Thumbnail ${c+1}`,className:"w-full h-full",width:150,height:150,showPlaceholder:!1})},c))})]})},ie=({productPrice:r=0})=>{const[l,s]=a.useState(""),[d,x]=a.useState(!1),[n,h]=a.useState(null),[g,u]=a.useState(""),y=async()=>{if(!l||l.length<6){u("Please enter a valid 6-digit pincode");return}x(!0),u(""),h(null);try{const{data:i}=await S.post("/shipping/serviceability",{pincode:parseInt(l),weight:.5,cod:r>0?1:0});i&&i.serviceability?h({available:!0,message:"Delivery available in -2 business days",estimatedDelivery:"2-4 business days",couriers:i.couriers||["FedEx","DTDC"]}):h({available:!1,message:"Delivery not available at this pincode"})}catch(i){u("Unable to check serviceability. Please try again."),console.error("Serviceability check error:",i)}finally{x(!1)}};return e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx($,{size:20,className:"text-blue-600"}),e.jsx("h4",{className:"font-bold text-gray-800",children:"Check Delivery Availability"})]}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("input",{type:"text",placeholder:"Enter your pincode",value:l,onChange:i=>{s(i.target.value.slice(0,6)),u("")},maxLength:"6",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{onClick:y,disabled:d||!l,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:d?e.jsxs(e.Fragment,{children:[e.jsx(G,{size:16,className:"animate-spin"}),"Checking..."]}):"Check"})]}),g&&e.jsxs("div",{className:"flex items-start gap-2 text-red-600 bg-red-50 p-3 rounded-lg text-sm",children:[e.jsx(T,{size:16,className:"mt-0.5 flex-shrink-0"}),e.jsx("p",{children:g})]}),n&&e.jsx("div",{className:`p-3 rounded-lg text-sm ${n.available?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800"}`,children:e.jsx("div",{className:"flex items-start gap-2",children:n.available?e.jsxs(e.Fragment,{children:[e.jsx(J,{size:16,className:"mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:n.message}),n.couriers&&e.jsxs("p",{className:"mt-1",children:["Available via: ",n.couriers.join(", ")]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{size:16,className:"mt-0.5 flex-shrink-0"}),e.jsx("p",{children:n.message})]})})})]})},ne=()=>{const r=a.useContext(_);if(!r)throw new Error("useFlyingElement must be used within FlyingElementProvider");const{addFlyingElement:l}=r;return{animateAddToCart:(d,x,n="Added to cart")=>{if(!d||!x)return;const h=d.getBoundingClientRect(),g=x.getBoundingClientRect();l(h,g,n)},addFlyingElement:l}},be=()=>{const{id:r}=U(),l=W(),[s,d]=a.useState(null),[x,n]=a.useState([]),[h,g]=a.useState(!0),[u,y]=a.useState(!1),[i,o]=a.useState(0),[c,N]=a.useState(""),[p,A]=a.useState(1),{addToCart:z}=q(),{user:L}=H(),{addToast:j}=a.useContext(O)||{},[b,w]=a.useState("description"),{animateAddToCart:D}=ne(),P=a.useRef(null),I=async()=>{try{g(!0);const{data:t}=await S.get(`/products/${r}`);d(t);const{data:m}=await S.get("/products"),v=m.products.filter(f=>f.category===t.category&&f._id!==t._id).slice(0,4);n(v)}catch(t){console.error("Error fetching product",t)}finally{g(!1)}};a.useEffect(()=>{I()},[r]);const B=async t=>{var m,v;if(t.preventDefault(),i===0){j&&j("Please select a rating","error");return}try{y(!0),await S.post(`/products/${r}/reviews`,{rating:i,comment:c}),j&&j("Review submitted successfully!","success"),o(0),N(""),I()}catch(f){j&&j(((v=(m=f.response)==null?void 0:m.data)==null?void 0:v.message)||"Failed to submit review","error")}finally{y(!1)}},M=()=>{const t=document.getElementById("cart-icon-container");P.current&&t&&D(P.current,t,s.image),z(s,p)},Z=()=>{z(s,p),l("/checkout/address")};return h?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):s?e.jsx(ae,{children:e.jsx("div",{className:"bg-background min-h-screen pb-12",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("nav",{className:"text-sm mb-6 text-gray-500",children:[e.jsx(C,{to:"/",className:"hover:text-primary",children:"Home"}),e.jsx("span",{className:"mx-2",children:"/"}),e.jsx(C,{to:"/shop",className:"hover:text-primary",children:"Shop"}),e.jsx("span",{className:"mx-2",children:"/"}),e.jsx("span",{className:"text-gray-800",children:s.name})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-0",children:[e.jsx("div",{className:"p-8 bg-gray-50 flex flex-col justify-between",ref:P,children:e.jsx(le,{images:s.images&&s.images.length>0?[s.image,...s.images]:[s.image]})}),e.jsxs("div",{className:"p-8 lg:p-12",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-serif font-bold text-primary mb-2",children:s.name}),e.jsx("div",{className:"text-sm text-secondary font-bold uppercase tracking-wider mb-4",children:s.category}),e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("div",{className:"flex text-secondary",children:[...Array(5)].map((t,m)=>e.jsx(R,{size:20,fill:m<s.rating?"currentColor":"none",className:m<s.rating?"":"text-gray-200"},m))}),e.jsxs("span",{className:"ml-3 text-gray-500 text-sm border-l pl-3 border-gray-300",children:["Read ",s.numReviews," Reviews"]})]}),e.jsxs("div",{className:"flex items-baseline gap-4 mb-8",children:[e.jsxs("span",{className:"text-3xl font-bold text-gray-900",children:["₹",s.price]}),e.jsx("span",{className:"text-green-600 text-sm font-medium bg-green-50 px-2 py-1 rounded",children:"In Stock"})]}),e.jsxs("p",{className:"text-gray-600 mb-8 leading-relaxed text-lg",children:[s.description.substring(0,150),"..."]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 mb-8",children:[e.jsxs("div",{className:"flex items-center border border-gray-300 rounded-full h-12 w-full sm:w-32 justify-between",children:[e.jsx("button",{onClick:()=>A(Math.max(1,p-1)),className:"w-12 sm:w-10 h-full hover:bg-gray-100 rounded-l-full flex items-center justify-center text-gray-600 font-bold text-xl",children:"-"}),e.jsx("div",{className:"flex-1 text-center font-bold text-gray-800",children:p}),e.jsx("button",{onClick:()=>A(Math.min(s.countInStock||10,p+1)),className:"w-12 sm:w-10 h-full hover:bg-gray-100 rounded-r-full flex items-center justify-center text-gray-600 font-bold text-xl",children:"+"})]}),e.jsxs("div",{className:"flex flex-1 gap-2 sm:gap-4",children:[e.jsxs(k,{onClick:Z,disabled:s.countInStock===0,className:"flex-1 bg-orange-500 text-white h-12 rounded-full font-bold hover:bg-opacity-90 transition shadow-lg hover:shadow-xl flex items-center justify-center gap-2 disabled:bg-gray-400 disabled:cursor-not-allowed border-none text-sm px-2",children:[e.jsx(K,{size:18}),"Buy Now"]}),e.jsxs(k,{onClick:M,disabled:s.countInStock===0,className:"flex-1 bg-primary text-white h-12 rounded-full font-bold hover:bg-opacity-90 transition shadow-lg hover:shadow-xl flex items-center justify-center gap-2 disabled:bg-gray-400 disabled:cursor-not-allowed border-none text-sm px-2",children:[e.jsx(ee,{size:18}),s.countInStock===0?"Out of Stock":"Add to Cart"]})]}),e.jsx("button",{className:"hidden sm:flex w-12 h-12 rounded-full border border-gray-200 items-center justify-center text-gray-400 hover:text-red-500 hover:bg-red-50 transition shadow-sm",title:"Add to Wishlist",children:e.jsx(se,{size:20})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-6 border-t border-gray-100 mb-6",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx($,{className:"text-primary mt-1",size:20}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-800 text-sm",children:"Free Shipping"}),e.jsx("p",{className:"text-xs text-gray-500",children:"On all orders above ₹999"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(te,{className:"text-primary mt-1",size:20}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-800 text-sm",children:"Authentic & Pure"}),e.jsx("p",{className:"text-xs text-gray-500",children:"100% genuine products"})]})]})]}),e.jsx(ie,{productPrice:s.price})]})]})}),e.jsx(E,{children:e.jsxs("div",{className:"mt-12 bg-white rounded-xl shadow-sm border border-gray-100 p-8",children:[e.jsxs("div",{className:"flex border-b border-gray-100 mb-8 overflow-x-auto",children:[e.jsx("button",{className:`pb-4 px-4 sm:px-6 font-bold text-base sm:text-lg whitespace-nowrap transition-colors ${b==="description"?"text-primary border-b-2 border-primary":"text-gray-400 hover:text-gray-600"}`,onClick:()=>w("description"),children:"Description"}),e.jsx("button",{className:`pb-4 px-4 sm:px-6 font-bold text-base sm:text-lg whitespace-nowrap transition-colors ${b==="benefits"?"text-primary border-b-2 border-primary":"text-gray-400 hover:text-gray-600"}`,onClick:()=>w("benefits"),children:"Benefits"}),e.jsx("button",{className:`pb-4 px-4 sm:px-6 font-bold text-base sm:text-lg whitespace-nowrap transition-colors ${b==="usage"?"text-primary border-b-2 border-primary":"text-gray-400 hover:text-gray-600"}`,onClick:()=>w("usage"),children:"How to Use"}),e.jsxs("button",{className:`pb-4 px-4 sm:px-6 font-bold text-base sm:text-lg whitespace-nowrap transition-colors ${b==="reviews"?"text-primary border-b-2 border-primary":"text-gray-400 hover:text-gray-600"}`,onClick:()=>w("reviews"),children:["Reviews (",s.numReviews,")"]})]}),e.jsxs("div",{className:"prose max-w-none text-gray-600",children:[b==="description"&&e.jsx("div",{children:e.jsx("p",{children:s.description})}),b==="benefits"&&e.jsxs("ul",{className:"list-disc pl-5 space-y-2",children:[e.jsx("li",{children:"Promotes overall wellness and balance."}),e.jsx("li",{children:"Formulated with time-tested Ayurvedic herbs."}),e.jsx("li",{children:"Supports natural body functions."}),e.jsx("li",{children:"Free from harmful chemicals."})]}),b==="usage"&&e.jsxs("div",{className:"flex gap-4 items-start bg-yellow-50 p-4 rounded-lg",children:[e.jsx(re,{className:"text-secondary shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-800",children:"Recommended Dosage"}),e.jsx("p",{children:"Take 1-2 tablets twice daily with warm water, or as directed by your physician."})]})]}),b==="reviews"&&e.jsxs("div",{children:[s.reviews.length===0?e.jsx("div",{className:"text-center py-10 bg-gray-50 rounded-xl",children:"No reviews yet. Be the first to review!"}):s.reviews.map(t=>{var m;return e.jsxs("div",{className:"border-b pb-4 mb-4 last:border-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-bold text-gray-800",children:t.name}),e.jsx("span",{className:"text-xs text-gray-400",children:(m=t.createdAt)==null?void 0:m.substring(0,10)})]}),e.jsx("div",{className:"flex text-secondary text-sm mb-2",children:[...Array(5)].map((v,f)=>e.jsx(R,{size:14,fill:f<t.rating?"currentColor":"none"},f))}),e.jsx("p",{className:"text-gray-600",children:t.comment})]},t._id)}),e.jsxs("div",{className:"mt-12 pt-8 border-t border-gray-100",children:[e.jsx("h3",{className:"text-xl font-serif font-bold text-gray-900 mb-6 text-center",children:"Write a Customer Review"}),L?e.jsxs("form",{onSubmit:B,className:"max-w-lg mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Rating"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(t=>e.jsx("button",{type:"button",onClick:()=>o(t),className:`p-1 transition-colors ${i>=t?"text-yellow-400":"text-gray-300"}`,children:e.jsx(R,{size:32,fill:i>=t?"currentColor":"none"})},t))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"comment",className:"block text-sm font-bold text-gray-700 mb-2",children:"Comment"}),e.jsx("textarea",{id:"comment",rows:"4",value:c,onChange:t=>N(t.target.value),className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:border-primary transition-colors text-sm",placeholder:"Share your experience with this product...",required:!0})]}),e.jsx("div",{className:"text-center",children:e.jsx(k,{type:"submit",disabled:u,className:"bg-primary text-white px-10 py-3 rounded-full font-bold shadow-lg hover:shadow-xl transition-all disabled:opacity-50 border-none",children:u?"Submitting...":"Post Review"})})]}):e.jsxs("div",{className:"text-center py-6 bg-gray-50 rounded-xl",children:[e.jsx("p",{className:"text-gray-600 mb-4 font-medium",children:"Please sign in to write a review"}),e.jsx(C,{to:`/login?redirect=product/${r}`,children:e.jsx(k,{className:"bg-primary text-white px-8 py-2 rounded-full font-bold border-none",children:"Login to Review"})})]})]})]})]})]})}),x.length>0&&e.jsx("div",{className:"mt-20",children:e.jsxs(E,{children:[e.jsxs("div",{className:"flex justify-between items-end mb-10",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-serif font-bold text-primary",children:"Related Products"}),e.jsxs("p",{className:"text-gray-500 mt-2",children:["More items you might find helpful from ",s.category,"."]})]}),e.jsx(C,{to:"/shop",className:"text-primary font-bold text-sm tracking-wider uppercase hover:text-secondary hover:underline underline-offset-4",children:"View All"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:x.map(t=>e.jsx(Q,{product:t},t._id))})]})})]})})}):e.jsx("div",{className:"text-center py-20",children:"Product not found"})};export{be as default};
