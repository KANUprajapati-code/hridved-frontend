import{j as e,a as d}from"./index-DsP1R5yV.js";import{e as v,b as N,r as l,L as w}from"./vendor-react-B8KVy-C4.js";import{y as C,a6 as m,O as A,ad as E}from"./vendor-ui-DMuw5F6C.js";import"./vendor-utils-C0Zqfgkc.js";const L=()=>{const{id:i}=v(),y=N(),s=!!i,[f,u]=l.useState(s),[p,x]=l.useState(!1),[t,g]=l.useState({code:"",discount:0,type:"percentage",expiryDate:"",minOrderAmount:0,isActive:!0});l.useEffect(()=>{s&&(async()=>{try{const{data:o}=await d.get("/coupons"),r=o.find(n=>n._id===i);r&&g({code:r.code,discount:r.discount,type:r.type,expiryDate:r.expiryDate.split("T")[0],minOrderAmount:r.minOrderAmount,isActive:r.isActive}),u(!1)}catch(o){console.error("Error fetching coupon:",o),u(!1)}})()},[i,s]);const a=c=>{const{name:o,value:r,type:n,checked:h}=c.target;g(j=>({...j,[o]:n==="checkbox"?h:r}))},b=async c=>{var o,r;c.preventDefault(),x(!0);try{s?await d.put(`/coupons/${i}`,t):await d.post("/coupons",t),y("/admin/promocodelist")}catch(n){console.error("Error saving coupon:",n),alert(((r=(o=n.response)==null?void 0:o.data)==null?void 0:r.message)||"Error saving coupon")}finally{x(!1)}};return f?e.jsx("div",{className:"text-center py-20 font-serif text-xl",children:"Loading..."}):e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[e.jsxs(w,{to:"/admin/promocodelist",className:"text-gray-500 hover:text-primary mb-6 flex items-center gap-2 transition-colors",children:[e.jsx(C,{size:18})," Back to Promo Codes"]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-xl border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"bg-primary p-6 text-white",children:[e.jsxs("h1",{className:"text-2xl font-serif font-bold flex items-center gap-2",children:[s?e.jsx(m,{size:24}):e.jsx(m,{size:24}),s?"Edit Promo Code":"Create New Promo Code"]}),e.jsx("p",{className:"text-primary-foreground/80 text-sm mt-1",children:"Define discounts and constraints for your customers."})]}),e.jsxs("form",{onSubmit:b,className:"p-8 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"col-span-1 md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(m,{size:16,className:"text-primary"})," Coupon Code"]}),e.jsx("input",{type:"text",name:"code",value:t.code,onChange:a,placeholder:"E.G. WELLNESS20",className:"w-full border border-gray-200 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition uppercase font-bold tracking-widest",required:!0,disabled:s})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Discount Value"}),e.jsx("input",{type:"number",name:"discount",value:t.discount,onChange:a,className:"w-full border border-gray-200 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition",required:!0,min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Discount Type"}),e.jsxs("select",{name:"type",value:t.type,onChange:a,className:"w-full border border-gray-200 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition",children:[e.jsx("option",{value:"percentage",children:"Percentage (%)"}),e.jsx("option",{value:"fixed",children:"Fixed Amount (₹)"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(A,{size:16,className:"text-primary"})," Expiry Date"]}),e.jsx("input",{type:"date",name:"expiryDate",value:t.expiryDate,onChange:a,className:"w-full border border-gray-200 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Min. Order Amount (₹)"}),e.jsx("input",{type:"number",name:"minOrderAmount",value:t.minOrderAmount,onChange:a,className:"w-full border border-gray-200 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition",min:"0"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg border border-gray-100",children:[e.jsx("input",{type:"checkbox",id:"isActive",name:"isActive",checked:t.isActive,onChange:a,className:"w-5 h-5 accent-primary cursor-pointer"}),e.jsx("label",{htmlFor:"isActive",className:"text-sm font-bold text-gray-700 cursor-pointer",children:"Promo code is active and can be used immediately"})]}),e.jsx("button",{type:"submit",disabled:p,className:"w-full bg-primary text-white py-4 rounded-xl font-bold text-lg shadow-lg hover:bg-opacity-90 hover:shadow-xl transition-all flex items-center justify-center gap-2 disabled:opacity-50 border-none",children:p?"Processing...":e.jsxs(e.Fragment,{children:[e.jsx(E,{size:20}),s?"Update Promo Code":"Save Promo Code"]})})]})]})]})};export{L as default};
