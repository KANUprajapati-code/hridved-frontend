import{T as oe,a as h,j as e}from"./index-DsP1R5yV.js";import{e as ne,b as ie,r,L as A}from"./vendor-react-B8KVy-C4.js";import{y as Q,ac as V,X as de,af as ce,E as Z,ad as ge}from"./vendor-ui-DMuw5F6C.js";import"./vendor-utils-C0Zqfgkc.js";const be=()=>{const{id:o}=ne(),z=ie(),{addToast:a}=r.useContext(oe)||{},[ee,f]=r.useState(!0),[g,P]=r.useState(!1),[u,B]=r.useState(!1),[m,F]=r.useState(""),[y,j]=r.useState(""),[i,I]=r.useState(""),[v,L]=r.useState(""),[te,re]=r.useState(""),[c,N]=r.useState(""),[U,R]=r.useState("General Wellness"),[d,w]=r.useState([]),[x,q]=r.useState(""),[S,M]=r.useState(""),[p,C]=r.useState(""),[k,O]=r.useState(""),[T,H]=r.useState(""),[$,G]=r.useState("5 min read"),[n,D]=r.useState("draft"),[W,Y]=r.useState(!1),ae=["Skin Care","Hair Health","Nutrition","Yoga","Stress Management","General Wellness","Ayurveda","Tips & Tricks","Product Guide","Other"],_=r.useCallback(async()=>{try{const{data:t}=await h.get(`/blogs/${o}`);F(t.title),j(t.slug),I(t.shortDescription),L(t.content),re(t.excerpt||""),N(t.image),R(t.category),w(t.tags||[]),M(t.author),C(t.authorImage||""),O(t.metaTitle||""),H(t.metaDescription||""),G(t.readTime||"5 min read"),D(t.status||"draft"),Y(t.isFeatured||!1),f(!1)}catch(t){a&&a("Failed to load blog","error"),console.error(t),f(!1)}},[o,a]);r.useEffect(()=>{o?_():f(!1)},[o,_]);const se=t=>{const l=t.target.value;F(l);const s=l.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-");j(s)},K=()=>{x.trim()&&!d.includes(x.trim())&&(w([...d,x.trim()]),q(""))},le=t=>{w(d.filter((l,s)=>s!==t))},X=async(t,l)=>{const s=t.target.files[0];if(!s)return;const b=new FormData;b.append("image",s),B(!0);try{const{data:E}=await h.post("/upload",b,{headers:{"Content-Type":"multipart/form-data"}});l(E),a&&a("Image uploaded successfully","success")}catch(E){a&&a("Failed to upload image","error"),console.error(E)}finally{B(!1)}},J=async(t,l=!1)=>{if(t.preventDefault(),!m.trim()||!i.trim()||!v.trim()||!c||!S.trim()){a&&a("Please fill in all required fields","error");return}try{P(!0);const s={title:m,slug:y,shortDescription:i,content:v,excerpt:te||i.substring(0,300),image:c,category:U,tags:d,author:S,authorImage:p,metaTitle:k||m.substring(0,60),metaDescription:T||i.substring(0,160),readTime:$,status:l?"published":n,isFeatured:W};if(o)await h.put(`/blogs/${o}`,s),a&&a("Blog updated successfully","success");else{const{data:b}=await h.post("/blogs",s);a&&a("Blog created successfully","success"),z(`/admin/blog/${b._id}/edit`);return}z("/admin/bloglist")}catch(s){a&&a("Failed to save blog","error"),console.error(s)}finally{P(!1)}};return ee?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Loading blog..."})]}):e.jsxs("div",{children:[e.jsxs(A,{to:"/admin/bloglist",className:"inline-flex items-center text-primary hover:text-opacity-80 mb-6 transition-colors font-bold text-sm",children:[e.jsx(Q,{size:18,className:"mr-2"})," Back to Blogs"]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 bg-gradient-to-r from-primary/5 to-secondary/5 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:o?"Edit Blog":"Create New Blog"}),o&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["ID: ",o]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${n==="published"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:n==="published"?"Published":"Draft"})})]}),e.jsxs("form",{onSubmit:J,className:"p-8 space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Blog Title *"}),e.jsx("input",{type:"text",placeholder:"Enter an engaging blog title",value:m,onChange:se,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"URL Slug"}),e.jsx("input",{type:"text",placeholder:"auto-generated-from-title",value:y,onChange:t=>j(t.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all text-gray-500"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Auto-generated from title. Preview: /blog/",y]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Short Description *"}),e.jsx("textarea",{rows:"2",placeholder:"A compelling summary for blog listings and search results...",value:i,onChange:t=>I(t.target.value),maxLength:"500",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all resize-none"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[i.length,"/500 characters"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Featured Image *"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Enter image URL or upload",value:c,onChange:t=>N(t.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"})}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",id:"image-file",onChange:t=>X(t,N),className:"hidden",accept:"image/*"}),e.jsxs("label",{htmlFor:"image-file",className:"bg-gray-100 text-gray-700 px-6 py-3 rounded-lg cursor-pointer hover:bg-gray-200 border border-gray-300 flex items-center gap-2 transition-colors font-medium whitespace-nowrap",children:[e.jsx(V,{size:18}),u?"Uploading...":"Upload Image"]})]})]}),c&&e.jsx("div",{className:"mt-4 rounded-lg overflow-hidden border border-gray-200 max-w-sm",children:e.jsx("img",{src:c,alt:"Preview",className:"w-full h-40 object-cover"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Category *"}),e.jsx("select",{value:U,onChange:t=>R(t.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all bg-white",children:ae.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Author Name *"}),e.jsx("input",{type:"text",placeholder:"e.g. Ayurveda Expert",value:S,onChange:t=>M(t.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Read Time"}),e.jsx("input",{type:"text",placeholder:"e.g. 5 min read",value:$,onChange:t=>G(t.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Author Image"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Enter author image URL or upload",value:p,onChange:t=>C(t.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"})}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",id:"author-image-file",onChange:t=>X(t,C),className:"hidden",accept:"image/*"}),e.jsxs("label",{htmlFor:"author-image-file",className:"bg-gray-100 text-gray-700 px-6 py-3 rounded-lg cursor-pointer hover:bg-gray-200 border border-gray-300 flex items-center gap-2 transition-colors font-medium whitespace-nowrap",children:[e.jsx(V,{size:18}),u?"Uploading...":"Upload"]})]})]}),p&&e.jsx("div",{className:"mt-4 w-16 h-16 rounded-full overflow-hidden border border-gray-200",children:e.jsx("img",{src:p,alt:"Author",className:"w-full h-full object-cover"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Tags"}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("input",{type:"text",placeholder:"Add tags (press Enter or Add)",value:x,onChange:t=>q(t.target.value),onKeyPress:t=>{t.key==="Enter"&&(t.preventDefault(),K())},className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"}),e.jsx("button",{type:"button",onClick:K,className:"bg-gray-100 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-200 border border-gray-300 transition-colors font-medium",children:"Add"})]}),d.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:d.map((t,l)=>e.jsxs("span",{className:"inline-flex items-center gap-2 bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm font-medium",children:[t,e.jsx("button",{type:"button",onClick:()=>le(l),className:"hover:text-blue-900",children:e.jsx(de,{size:14})})]},l))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Blog Content *"}),e.jsx("textarea",{rows:"15",placeholder:"Write your comprehensive blog content here. You can use line breaks for formatting...",value:v,onChange:t=>L(t.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all font-mono text-sm resize-vertical"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Plain text format. Use line breaks for paragraphs."})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"SEO Optimization"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Meta Title"}),e.jsx("input",{type:"text",placeholder:"SEO-friendly title (recommended 60 characters max)",value:k,onChange:t=>O(t.target.value.substring(0,60)),maxLength:"60",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[k.length,"/60 characters"]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Meta Description"}),e.jsx("textarea",{rows:"2",placeholder:"Meta description for search results (recommended 160 characters max)",value:T,onChange:t=>H(t.target.value.substring(0,160)),maxLength:"160",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all resize-none"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[T.length,"/160 characters"]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Publishing Options"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(A,{to:"/admin/bloglist",className:"flex items-center gap-2 text-gray-600 hover:text-primary mb-6 transition-colors font-medium",children:[e.jsx(Q,{size:20})," Back to Blogs"]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:W,onChange:t=>Y(t.target.checked),className:"w-5 h-5 text-primary rounded focus:ring-primary accent-primary"}),e.jsx("span",{className:"font-medium text-gray-700",children:"Featured on blog homepage"})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("label",{className:"text-sm font-bold text-gray-700 block mb-3",children:"Status"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"draft",checked:n==="draft",onChange:t=>D(t.target.value),className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-gray-700",children:"Save as Draft"}),e.jsx(ce,{size:14,className:"text-gray-400"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"published",checked:n==="published",onChange:t=>D(t.target.value),className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-gray-700",children:"Publish (visible to all)"}),e.jsx(Z,{size:14,className:"text-green-500"})]})]})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6 flex flex-col sm:flex-row gap-4 justify-end",children:[e.jsx(A,{to:"/admin/bloglist",className:"px-6 py-3 rounded-lg border border-gray-300 text-gray-700 font-bold hover:bg-gray-50 transition-colors text-center",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:g||u,className:"bg-gray-600 text-white px-8 py-3 rounded-lg font-bold shadow-lg hover:bg-gray-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(ge,{size:20}),g?"Saving...":"Save as "+n.charAt(0).toUpperCase()+n.slice(1)]}),n==="draft"&&e.jsxs("button",{type:"button",onClick:t=>J(t,!0),disabled:g||u,className:"bg-primary text-white px-8 py-3 rounded-lg font-bold shadow-lg shadow-primary/30 hover:bg-opacity-90 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(Z,{size:20}),g?"Publishing...":"Save & Publish"]})]})]})]})]})};export{be as default};
