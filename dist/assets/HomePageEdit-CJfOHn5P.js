import{j as e,a as c}from"./index-jnhJKHVM.js";import{r as m,L as D}from"./vendor-react-B8KVy-C4.js";import{c as y}from"./imageCompression-nMn3csfP.js";import{y as I,ae as g}from"./vendor-ui-cGIEGKxt.js";import"./vendor-utils-C0Zqfgkc.js";const A=()=>{var v;const[N,f]=m.useState(!0),[l,n]=m.useState({title:"",subtitle:"",ctaText:"",ctaLink:"",image:""}),[r,p]=m.useState({title:"",subtitle:"",image:""}),[i,x]=m.useState({items:[]}),[j,d]=m.useState(!1);m.useEffect(()=>{(async()=>{try{const{data:a}=await c.get("/content");a.hero&&n(a.hero),a.tradition&&p(a.tradition),a.testimonials&&x(a.testimonials),f(!1)}catch(a){console.error("Error fetching content",a),f(!1)}})()},[]);const w=async t=>{const a=t.target.files[0];if(a){d(!0);try{const s=await y(a,{quality:.7,maxWidth:1920}),o=new FormData;o.append("image",s);const{data:u}=await c.post("/upload",o),h=u.replace(/\\/g,"/");n({...l,image:h}),d(!1)}catch(s){console.error("Hero image upload failed:",s),d(!1),alert("Upload failed. Try a smaller image.")}}},T=async t=>{const a=t.target.files[0];if(a){d(!0);try{const s=await y(a,{quality:.7,maxWidth:1200}),o=new FormData;o.append("image",s);const{data:u}=await c.post("/upload",o),h=u.replace(/\\/g,"/");p({...r,image:h}),d(!1)}catch(s){console.error("Tradition image upload failed:",s),d(!1),alert("Upload failed. Try a smaller image.")}}},k=async t=>{t.preventDefault();try{await c.put("/content/hero",l),alert("Hero section updated!")}catch{alert("Error updating hero")}},C=async t=>{t.preventDefault();try{await c.put("/content/tradition",r),alert("Tradition section updated!")}catch{alert("Error updating tradition")}},S=async t=>{t.preventDefault();try{await c.put("/content/testimonials",i),alert("Testimonials updated!")}catch{alert("Error updating testimonials")}},b=(t,a,s)=>{const o=[...i.items||[]];o[t]||(o[t]={}),o[t][a]=s,x({...i,items:o})},L=()=>{x({...i,items:[...i.items||[],{title:"Name",description:"Feedback",link:"Location/Role"}]})},H=t=>{const a=i.items.filter((s,o)=>o!==t);x({...i,items:a})};return N?e.jsx("div",{className:"p-8",children:"Loading content..."}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs(D,{to:"/admin",className:"flex items-center gap-2 text-gray-600 hover:text-primary mb-6 transition-colors",children:[e.jsx(I,{size:20})," Back to Dashboard"]}),e.jsx("h1",{className:"text-3xl font-bold font-serif text-primary mb-8",children:"Edit Home Page Content"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow border",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 border-b pb-2",children:"Hero Section"}),e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-1",children:"Title"}),e.jsx("input",{type:"text",value:l.title,onChange:t=>n({...l,title:t.target.value}),className:"w-full border p-2 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-1",children:"Subtitle"}),e.jsx("textarea",{value:l.subtitle,onChange:t=>n({...l,subtitle:t.target.value}),className:"w-full border p-2 rounded",rows:"3"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-1",children:"CTA Text"}),e.jsx("input",{type:"text",value:l.ctaText,onChange:t=>n({...l,ctaText:t.target.value}),className:"w-full border p-2 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-1",children:"CTA Link"}),e.jsx("input",{type:"text",value:l.ctaLink,onChange:t=>n({...l,ctaLink:t.target.value}),className:"w-full border p-2 rounded"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-1",children:"Hero Image"}),e.jsx("input",{type:"text",value:l.image,onChange:t=>n({...l,image:t.target.value}),className:"w-full border p-2 rounded mb-2",placeholder:"Image URL or Upload"}),e.jsx("input",{type:"file",id:"hero-image-file",className:"hidden",onChange:w}),e.jsx("label",{htmlFor:"hero-image-file",className:"cursor-pointer bg-gray-100 py-2 px-4 rounded border hover:bg-gray-200 inline-block text-sm font-bold",children:j?"Uploading...":"Upload Image"})]}),e.jsxs("button",{type:"submit",className:"bg-primary text-white px-4 py-2 rounded flex items-center gap-2 hover:bg-opacity-90",children:[e.jsx(g,{size:16})," Save Hero"]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow border",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 border-b pb-2",children:"Tradition Section"}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-1",children:"Title"}),e.jsx("input",{type:"text",value:r.title,onChange:t=>p({...r,title:t.target.value}),className:"w-full border p-2 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-1",children:"Content/Description"}),e.jsx("textarea",{value:r.subtitle,onChange:t=>p({...r,subtitle:t.target.value}),className:"w-full border p-2 rounded",rows:"5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-1",children:"Image URL"}),e.jsx("input",{type:"text",value:r.image,onChange:t=>p({...r,image:t.target.value}),className:"w-full border p-2 rounded mb-2"}),e.jsx("input",{type:"file",id:"tradition-image-file",className:"hidden",onChange:T}),e.jsx("label",{htmlFor:"tradition-image-file",className:"cursor-pointer bg-gray-100 py-2 px-4 rounded border hover:bg-gray-200 inline-block text-sm font-bold",children:j?"Uploading...":"Upload Image"})]}),e.jsxs("button",{type:"submit",className:"bg-primary text-white px-4 py-2 rounded flex items-center gap-2 hover:bg-opacity-90",children:[e.jsx(g,{size:16})," Save Tradition"]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow border md:col-span-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Testimonials"}),e.jsx("button",{type:"button",onClick:L,className:"text-primary text-sm font-bold hover:underline",children:"+ Add Testimonial"})]}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[(v=i.items)==null?void 0:v.map((t,a)=>e.jsxs("div",{className:"bg-gray-50 p-4 rounded border relative",children:[e.jsx("button",{type:"button",onClick:()=>H(a),className:"absolute top-2 right-2 text-red-500 text-xs font-bold hover:underline",children:"Remove"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold mb-1",children:"Customer Name (Title)"}),e.jsx("input",{type:"text",value:t.title||"",onChange:s=>b(a,"title",s.target.value),className:"w-full border p-2 rounded text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold mb-1",children:"Location/Role (Link)"}),e.jsx("input",{type:"text",value:t.link||"",onChange:s=>b(a,"link",s.target.value),className:"w-full border p-2 rounded text-sm"})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-xs font-bold mb-1",children:"Testimonial (Description)"}),e.jsx("textarea",{value:t.description||"",onChange:s=>b(a,"description",s.target.value),className:"w-full border p-2 rounded text-sm",rows:"2"})]})]})]},a)),e.jsxs("button",{type:"submit",className:"bg-primary text-white px-4 py-2 rounded flex items-center gap-2 hover:bg-opacity-90",children:[e.jsx(g,{size:16})," Save Testimonials"]})]})]})]})]})};export{A as default};
