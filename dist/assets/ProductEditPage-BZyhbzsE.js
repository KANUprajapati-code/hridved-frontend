import{j as e,a as l}from"./index-jnhJKHVM.js";import{e as G,b as Y,r as s,L as _}from"./vendor-react-B8KVy-C4.js";import{c as E}from"./imageCompression-nMn3csfP.js";import{y as J,ad as L}from"./vendor-ui-cGIEGKxt.js";import"./vendor-utils-C0Zqfgkc.js";const Z=()=>{const{id:i}=G(),H=Y(),[m,p]=s.useState(""),[g,f]=s.useState(0),[x,c]=s.useState(""),[b,h]=s.useState(""),[y,j]=s.useState(""),[v,N]=s.useState(0),[w,S]=s.useState(""),[k,C]=s.useState(!1),[I,d]=s.useState([]),[U,B]=s.useState(""),[q,F]=s.useState(""),[P,o]=s.useState(!1),[M,D]=s.useState(!0),[T,A]=s.useState([]);s.useEffect(()=>{const a=async()=>{try{const{data:t}=await l.get("/categories");A(t)}catch(t){console.error("Error fetching categories:",t)}},r=async()=>{try{const{data:t}=await l.get(`/products/${i}`);p(t.name),f(t.price),c(t.image),h(t.brand),j(t.category),N(t.countInStock),S(t.description||""),B(t.benefits||""),F(t.howToUse||""),C(t.isBestseller||!1),d(t.images||[]),D(!1)}catch(t){console.error(t),D(!1)}};a(),r()},[i]);const z=async a=>{const r=a.target.files[0];if(r){o(!0);try{const t=await E(r,{quality:.7,maxWidth:1600}),n=new FormData;n.append("image",t);const{data:u}=await l.post("/upload",n);c(u),o(!1)}catch(t){console.error("Upload failed:",t),alert("Image upload failed. If the image is very large, try a smaller one."),o(!1)}}},R=async a=>{const r=Array.from(a.target.files);if(r.length!==0){if(r.length>5){alert("You can only upload up to 5 images");return}o(!0);try{const t=new FormData;for(const u of r){const $=await E(u,{quality:.7,maxWidth:1200});t.append("images",$)}const{data:n}=await l.post("/upload/multiple",t);d(n),o(!1)}catch(t){console.error("Multiple upload failed:",t),alert("Multiple images upload failed. Try uploading fewer or smaller images."),o(!1)}}},W=async a=>{a.preventDefault();try{await l.put(`/products/${i}`,{name:m,price:g,image:x,brand:b,category:y,description:w,countInStock:v,isBestseller:k,images:I,benefits:U,howToUse:q}),H("/admin/productlist")}catch(r){console.error(r)}};return M?e.jsx("div",{className:"text-center py-20",children:"Loading..."}):e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[e.jsxs(_,{to:"/admin/productlist",className:"text-gray-500 hover:text-primary mb-4 flex items-center gap-2 transition-colors",children:[e.jsx(J,{size:18})," Go Back"]}),e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md border",children:[e.jsx("h1",{className:"text-2xl font-serif font-bold text-primary mb-6",children:"Edit Product"}),e.jsxs("form",{onSubmit:W,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-bold mb-2",children:"Name"}),e.jsx("input",{type:"text",required:!0,className:"w-full border p-2 rounded focus:outline-none focus:border-secondary",value:m,onChange:a=>p(a.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-bold mb-2",children:"Price"}),e.jsx("input",{type:"number",required:!0,className:"w-full border p-2 rounded focus:outline-none focus:border-secondary",value:g,onChange:a=>f(a.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-bold mb-2",children:"Image"}),e.jsx("input",{type:"text",required:!0,className:"w-full border p-2 rounded focus:outline-none focus:border-secondary mb-2",value:x,onChange:a=>c(a.target.value)}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",id:"image-file",className:"hidden",onChange:z}),e.jsxs("label",{htmlFor:"image-file",className:"cursor-pointer bg-gray-100 py-2 px-4 rounded border hover:bg-gray-200 inline-flex items-center gap-2",children:[e.jsx(L,{size:16})," ",P?"Uploading...":"Upload Image"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-bold mb-2",children:"Additional Images (Max 5)"}),e.jsx("input",{type:"text",className:"w-full border p-2 rounded focus:outline-none focus:border-secondary mb-2",value:I.join(", "),onChange:a=>d(a.target.value.split(",").map(r=>r.trim())),placeholder:"Enter image URLs comma separated"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",id:"multiple-images-file",className:"hidden",multiple:!0,onChange:R}),e.jsxs("label",{htmlFor:"multiple-images-file",className:"cursor-pointer bg-gray-100 py-2 px-4 rounded border hover:bg-gray-200 inline-flex items-center gap-2",children:[e.jsx(L,{size:16})," ",P?"Uploading...":"Upload Images"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-bold mb-2",children:"Category"}),e.jsxs("select",{required:!0,className:"w-full border p-2 rounded focus:outline-none focus:border-secondary transition-all bg-white",value:y,onChange:a=>j(a.target.value),children:[e.jsx("option",{value:"",children:"Select Category"}),T.map(a=>e.jsx("option",{value:a.name,children:a.name},a._id))]}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1 italic",children:"Manage categories in the Admin Sidebar if the one you need is missing."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-bold mb-2",children:"Brand"}),e.jsx("input",{type:"text",required:!0,className:"w-full border p-2 rounded focus:outline-none focus:border-secondary",value:b,onChange:a=>h(a.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-bold mb-2",children:"Count In Stock"}),e.jsx("input",{type:"number",required:!0,className:"w-full border p-2 rounded focus:outline-none focus:border-secondary",value:v,onChange:a=>N(a.target.value)})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"isBestseller",className:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded",checked:k,onChange:a=>C(a.target.checked)}),e.jsx("label",{htmlFor:"isBestseller",className:"ml-2 block text-gray-700 font-bold",children:"Is Bestseller?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-bold mb-2",children:"Description"}),e.jsx("textarea",{required:!0,rows:"4",className:"w-full border p-2 rounded focus:outline-none focus:border-secondary",value:w,onChange:a=>S(a.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-bold mb-2",children:"Benefits"}),e.jsx("textarea",{rows:"4",className:"w-full border p-2 rounded focus:outline-none focus:border-secondary",value:U,onChange:a=>B(a.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-bold mb-2",children:"How To Use"}),e.jsx("textarea",{rows:"4",className:"w-full border p-2 rounded focus:outline-none focus:border-secondary",value:q,onChange:a=>F(a.target.value)})]}),e.jsx("button",{type:"submit",className:"w-full bg-primary text-white py-2 rounded hover:bg-opacity-90 transition font-bold",children:"Update Product"})]})]})]})};export{Z as default};
