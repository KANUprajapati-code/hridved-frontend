import{j as e,a as m}from"./index-jnhJKHVM.js";import{e as U,b as q,r as t,L as D}from"./vendor-react-B8KVy-C4.js";import{A as I}from"./AnimatedButton-CtjKepQT.js";import{y as A,a as P,o as F,ad as C,ae as R}from"./vendor-ui-cGIEGKxt.js";import"./vendor-utils-C0Zqfgkc.js";const G=()=>{const{id:n}=U(),S=q(),l=!!n,[o,y]=t.useState(""),[h,x]=t.useState(""),[c,u]=t.useState(""),[b,j]=t.useState(""),[N,d]=t.useState(!1),[p,f]=t.useState(!1),[w,g]=t.useState(null),[k,v]=t.useState(!1);t.useEffect(()=>{l&&(async()=>{try{d(!0);const{data:s}=await m.get(`/categories/${n}`);y(s.name),x(s.slug),u(s.image),j(s.description||"")}catch(s){g("Failed to fetch category details"),console.error(s)}finally{d(!1)}})()},[n,l]),t.useEffect(()=>{if(!l&&o){const a=o.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");x(a)}},[o,l]);const E=async a=>{const s=a.target.files[0],i=new FormData;i.append("image",s),f(!0);try{const r={headers:{"Content-Type":"multipart/form-data"}},{data:L}=await m.post("/upload",i,r);u(L),f(!1)}catch(r){console.error(r),f(!1),g("Image upload failed")}},z=async a=>{var s,i;a.preventDefault(),g(null),v(!1),d(!0);try{const r={name:o,slug:h,image:c,description:b};l?await m.put(`/categories/${n}`,r):await m.post("/categories",r),v(!0),setTimeout(()=>{S("/admin/categorylist")},1500)}catch(r){g(((i=(s=r.response)==null?void 0:s.data)==null?void 0:i.message)||"Something went wrong"),console.error(r)}finally{d(!1)}};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs(D,{to:"/admin/categorylist",className:"flex items-center gap-2 text-gray-600 hover:text-primary mb-6 transition-colors",children:[e.jsx(A,{size:20})," Back to Categories"]}),e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-xl overflow-hidden border border-gray-100",children:[e.jsxs("div",{className:"bg-primary p-8 text-white relative",children:[e.jsx("h1",{className:"text-3xl font-display font-bold",children:l?"Edit Category":"Add New Category"}),e.jsx("p",{className:"text-white/70 mt-2",children:l?`Updating ${o}`:"Create a fresh category for your shop"})]}),e.jsxs("form",{onSubmit:z,className:"p-8 space-y-6",children:[w&&e.jsxs("div",{className:"bg-red-50 text-red-600 p-4 rounded-xl flex items-center gap-3 animate-shake",children:[e.jsx(P,{size:20}),e.jsx("span",{className:"text-sm font-bold",children:w})]}),k&&e.jsxs("div",{className:"bg-green-50 text-green-600 p-4 rounded-xl flex items-center gap-3",children:[e.jsx(F,{size:20}),e.jsx("span",{className:"text-sm font-bold",children:"Category saved successfully! Redirecting..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-black uppercase tracking-widest text-gray-400",children:"Category Name"}),e.jsx("input",{type:"text",placeholder:"e.g. Skin Care",className:"w-full bg-gray-50 border-gray-100 rounded-xl px-5 py-3 focus:ring-2 focus:ring-primary outline-none transition-all font-bold",value:o,onChange:a=>y(a.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-black uppercase tracking-widest text-gray-400",children:"URL Slug"}),e.jsx("input",{type:"text",placeholder:"skin-care",className:"w-full bg-gray-50 border-gray-100 rounded-xl px-5 py-3 focus:ring-2 focus:ring-primary outline-none transition-all font-mono italic text-sm",value:h,onChange:a=>x(a.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-black uppercase tracking-widest text-gray-400",children:"Description"}),e.jsx("textarea",{placeholder:"Pure herbal formulations for...",rows:"3",className:"w-full bg-gray-50 border-gray-100 rounded-xl px-5 py-3 focus:ring-2 focus:ring-primary outline-none transition-all",value:b,onChange:a=>j(a.target.value)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"text-xs font-black uppercase tracking-widest text-gray-400",children:"Category Image (Square 1:1 recommended)"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[e.jsxs("div",{className:"w-32 h-32 md:w-40 md:h-40 bg-gray-50 rounded-2xl border-2 border-dashed border-gray-200 overflow-hidden flex items-center justify-center relative group",children:[c?e.jsx("img",{src:c,alt:"Preview",className:"w-full h-full object-cover"}):e.jsxs("div",{className:"text-center p-4",children:[e.jsx(C,{className:"mx-auto text-gray-300 mb-2",size:32}),e.jsx("span",{className:"text-[10px] text-gray-400 block",children:"No Image"})]}),p&&e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 border-2 border-white border-t-transparent rounded-full animate-spin"})})]}),e.jsxs("div",{className:"flex-grow space-y-4 w-full",children:[e.jsx("input",{type:"text",placeholder:"Image URL or upload below",className:"w-full bg-gray-50 border-gray-100 rounded-xl px-5 py-3 focus:ring-2 focus:ring-primary outline-none transition-all text-sm mb-2",value:c,onChange:a=>u(a.target.value),required:!0}),e.jsxs("label",{className:"relative flex items-center justify-center gap-2 bg-gray-100 hover:bg-gray-200 text-gray-700 py-3 rounded-xl cursor-pointer transition-all font-bold text-sm",children:[e.jsx(C,{size:18}),e.jsx("span",{children:p?"Processing...":"Upload Square Image"}),e.jsx("input",{type:"file",className:"hidden",onChange:E})]}),e.jsx("p",{className:"text-[11px] text-gray-400 italic",children:"Square images (1:1 aspect ratio) look best in the homepage circles."})]})]})]}),e.jsx(I,{type:"submit",disabled:N||p,className:"w-full bg-primary text-white py-4 rounded-2xl font-bold text-lg flex items-center justify-center gap-2 shadow-2xl hover:shadow-primary/20 transition-all mt-8",children:N?e.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(R,{size:20})," ",l?"Update Category":"Create Category"]})})]})]})})]})};export{G as default};
